<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doorbin Waste - Master Service Agreement</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --dark-green: #2E8B57; --lime-green: #ADFF2F; --bg-dark: #121212; --card-bg: #1a1a1a; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-dark); color: #f3f4f6; -webkit-font-smoothing: antialiased; }
        .accent-lime { color: var(--lime-green); }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #1f2937; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: var(--dark-green); border-radius: 10px; }
        .legal-text b { color: white; font-weight: 700; }
        .legal-text h3 { color: white; font-weight: 700; text-transform: uppercase; border-bottom: 1px solid #374151; padding-bottom: 4px; margin-top: 24px; margin-bottom: 12px; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="min-h-screen py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-4xl mx-auto">
        
        <!-- PAGE 1: SERVICE ACCEPTANCE PROTOCOL -->
        <div id="page-1" class="fade-in">
            <header class="flex flex-col items-center mb-12 text-center">
                <img src="https://i.ibb.co/7NyScgsQ/doorbin-icon-new.png" alt="Logo" class="w-24 mb-6"/>
                <h1 class="text-4xl font-bold tracking-tight mb-2">Service Acceptance Protocol</h1>
                <p class="text-gray-400 text-lg">Doorbin Waste Professional Management Agreement</p>
            </header>

            <div class="bg-card-bg p-10 rounded-3xl border border-gray-800 mb-10 leading-relaxed text-gray-300 text-lg space-y-6 shadow-2xl">
                <p>
                    This Professional Service Agreement governs the door-to-door waste collection and management services provided by <b>Doorbin Waste LLC</b>. Our specialized Valet Trash solution is meticulously designed to enhance multi-family residential properties and condominiums through reliable, sustainable, and professional waste removal protocols.
                </p>
                <p>
                    By proceeding, you acknowledge that our team possesses the technical capacity, industry experience, and necessary resources to manage on-site waste safely and efficiently. This agreement outlines the mutual obligations, service schedules, and performance standards required to maintain optimal environmental conditions for your residents.
                </p>
                <p>
                    Please review the specific details regarding property units, frequency, and pricing in the full 
                    <button id="link-to-terms" class="accent-lime font-bold hover:underline focus:outline-none">Terms of Service</button> 
                    before final submission.
                </p>
            </div>

            <form id="acceptance-form" method="POST" action="https://n8n.doorbinwaste.com/webhook/consultar-cotizacion">
                <input type="hidden" name="airtable_record_id" id="hid-record-id">
                <div class="space-y-5 mb-10 border-t border-gray-800 pt-10 text-base">
                    <label class="flex items-start space-x-4 cursor-pointer group">
                        <input type="checkbox" id="check-1" required class="mt-1 w-6 h-6 rounded border-gray-700 bg-gray-800 text-[#2E8B57] focus:ring-offset-transparent">
                        <span class="text-gray-400 group-hover:text-white transition-colors">I have read and agree to the Doorbin Waste Master Service Agreement.</span>
                    </label>
                    <label class="flex items-start space-x-4 cursor-pointer group">
                        <input type="checkbox" id="check-2" required class="mt-1 w-6 h-6 rounded border-gray-700 bg-gray-800 text-[#2E8B57] focus:ring-offset-transparent">
                        <span class="text-gray-400 group-hover:text-white transition-colors">I confirm that I have authority to bind the client to these terms.</span>
                    </label>
                </div>
                <button type="submit" id="submit-btn" disabled class="w-full py-5 rounded-2xl text-xl font-bold transition-all bg-gray-800 text-gray-600 cursor-not-allowed uppercase tracking-wider">ACCEPT & CONTINUE</button>
            </form>
        </div>

        <!-- PAGE 2: FULL LEGAL AGREEMENT -->
        <div id="page-2" class="hidden">
            <header class="flex justify-between items-center mb-8 pb-4 border-b border-gray-800">
                <div class="flex items-center space-x-4">
                    <img src="https://i.ibb.co/7NyScgsQ/doorbin-icon-new.png" class="w-10">
                    <h2 class="text-2xl font-bold tracking-tight">Master Service Agreement</h2>
                </div>
                <button id="back-to-1" class="accent-lime text-sm font-bold hover:underline flex items-center">
                    <span class="mr-2">←</span> BACK TO OVERVIEW
                </button>
            </header>
            
            <div id="contract-view" class="bg-card-bg text-gray-300 p-10 rounded-2xl border border-gray-800 h-[65vh] overflow-y-auto custom-scrollbar legal-text leading-7 text-[15px] shadow-inner">
                <!-- Data-Driven Legal Content -->
            </div>
        </div>

        <footer class="mt-12 text-center text-gray-600 text-xs tracking-widest uppercase">
            © <span id="year"></span> Doorbin Waste Services LLC. All rights reserved.
        </footer>
    </div>

    <script>
        const contractData = { client: '...', property: '...', units: '...', rate: '...', summary: '...' };

        async function init() {
            document.getElementById('year').textContent = new Date().getFullYear();
            const recordId = new URLSearchParams(window.location.search).get('id');
            if (recordId) {
                document.getElementById('hid-record-id').value = recordId;
                try {
                    const res = await fetch(`https://n8n.doorbinwaste.com/webhook/consultar-cotizacion?id=${recordId}`);
                    const data = await res.json();
                    contractData.client = data.nombre_cliente || '[Client Name Pending]';
                    contractData.property = data.propiedad || '[Property Address Pending]';
                    contractData.units = data.unidades || '0';
                    contractData.rate = data.precio_mensual || '$0.00';
                    contractData.summary = data.detalle_servicio || 'Service details as specified in the proposal.';
                } catch (e) { console.error("Data Injection Error"); }
            }
            renderContract();
            
            document.getElementById('check-1').addEventListener('change', validate);
            document.getElementById('check-2').addEventListener('change', validate);
            document.getElementById('link-to-terms').addEventListener('click', () => { document.getElementById('page-1').classList.add('hidden'); document.getElementById('page-2').classList.remove('hidden'); });
            document.getElementById('back-to-1').addEventListener('click', () => { document.getElementById('page-2').classList.add('hidden'); document.getElementById('page-1').classList.remove('hidden'); });
        }

        function validate() {
            const btn = document.getElementById('submit-btn');
            const v = document.getElementById('check-1').checked && document.getElementById('check-2').checked;
            btn.disabled = !v;
            btn.className = v ? "w-full py-5 rounded-2xl text-xl font-bold transition-all bg-[#ADFF2F] text-black hover:brightness-110 shadow-lg" : "w-full py-5 rounded-2xl text-xl font-bold transition-all bg-gray-800 text-gray-600 cursor-not-allowed";
        }

        function renderContract() {
            document.getElementById('contract-view').innerHTML = `
                <div class="space-y-8 text-justify">
                    <h2 class="text-center font-bold text-xl text-white uppercase tracking-widest border-b border-gray-800 pb-6 mb-10">MASTER SERVICE AGREEMENT FOR DOOR-TO-DOOR WASTE COLLECTION</h2>
                    
                    <p><b>PARTIES:</b> This Agreement is entered into by and between <b>DOORBIN WASTE LLC</b>, a Florida Limited Liability Company, hereinafter referred to as the <b>"SERVICE PROVIDER"</b>, and <b>${contractData.client}</b>, hereinafter referred to as the <b>"CLIENT"</b>, collectively known as the "Parties".</p>
                    
                    <p><b>PROPERTY IDENTIFICATION:</b> The services outlined herein shall be exclusively rendered at the residential property located at <b>${contractData.property}</b>, hereinafter referred to as the "Property".</p>

                    <h3>I. DECLARATIONS</h3>
                    <p><b>1.1 Capacity:</b> The SERVICE PROVIDER declares it possesses the specialized technical knowledge, licensed equipment, and professional personnel required to execute door-to-door waste management (Valet Trash) in compliance with local health and safety standards.</p>
                    <p><b>1.2 Authority:</b> The CLIENT declares that it has the full legal authority to represent the Property and to enter into this binding agreement for the management of waste services on behalf of its residents.</p>

                    <h3>II. SCOPE OF SERVICES</h3>
                    <p><b>2.1 Operations:</b> The SERVICE PROVIDER shall provide comprehensive door-to-door waste collection for <b>${contractData.units} residential units</b>. The specific operational frequency and additional conditions are established as follows: <i>${contractData.summary}</i>.</p>
                    <p><b>2.2 Digital Oversight:</b> SERVICE PROVIDER will utilize its proprietary Service App to provide the CLIENT with automated activity logs and digital photographic evidence of service completion.</p>

                    <h3>III. TERM AND DURATION</h3>
                    <p><b>3.1 Initial Term:</b> This Agreement shall commence on the date of electronic acceptance and remain in full force for an initial period of twelve (12) months. This contract will automatically renew for successive twelve-month periods unless written notice of non-renewal is provided at least thirty (30) days prior to the expiration date.</p>

                    <h3>IV. FINANCIAL TERMS</h3>
                    <p><b>4.1 Monthly Rate:</b> The CLIENT agrees to pay a fixed monthly service fee of <b>${contractData.rate}</b>. Invoices will be generated on the first (1st) day of each month for the current month's service.</p>
                    <p><b>4.2 Payments:</b> All payments are due within fifteen (15) calendar days from the invoice date. Late payments may be subject to a monthly interest penalty of 5.0% on the outstanding balance.</p>

                    <h3>V. INDEMNIFICATION AND LIABILITY</h3>
                    <p><b>5.1 Insurance:</b> The SERVICE PROVIDER maintains comprehensive general liability insurance, vehicle insurance, and workers' compensation as required by the State of Florida. The SERVICE PROVIDER shall not be held liable for damages resulting from preexisting Property conditions or third-party negligence.</p>

                    <h3>VI. CONFIDENTIALITY AND GOVERNING LAW</h3>
                    <p><b>6.1 Data Protection:</b> Both parties agree to maintain the strict confidentiality of all resident data and internal property protocols disclosed during the term of this service.</p>
                    <p><b>6.2 Jurisdiction:</b> This Agreement shall be governed and construed in accordance with the laws of the State of Florida. Any legal dispute shall be settled exclusively in the competent courts located within the State of Florida.</p>

                    <h3>VII. TERMINATION AND BREACH OF CONTRACT</h3>
                    <p><b>7.1 Early Termination:</b> Termination of this Agreement by the CLIENT without cause prior to the expiration of the initial twelve (12) month term shall incur a mandatory early termination fee equal to <b>fifty percent (50%) of the current monthly service rate</b>, in addition to any outstanding balances due.</p>
                    <p><b>7.2 Force Majeure:</b> Either party may terminate this Agreement without penalty upon written notice in the event of Force Majeure or circumstances beyond reasonable control that render the fulfillment of services impossible.</p>
                    <p><b>7.3 Default and Suspension:</b> Proven violations of contractual obligations by either party, or repetitive failure by the CLIENT to meet financial obligations, may result in the immediate suspension of services and/or the permanent closure of the contract at the SERVICE PROVIDER’S sole discretion.</p>

                    <div class="mt-16 pt-10 border-t border-gray-800 text-[12px] text-gray-500 italic text-center leading-relaxed">
                        <b>LEGAL NOTICE:</b> This digital document constitutes a Master Service Agreement executed via electronic acceptance. By clicking "ACCEPT & CONTINUE", the CLIENT certifies that they have read, understood, and voluntarily agreed to be bound by all terms, conditions, and operational standards set forth by Doorbin Waste LLC.
                    </div>
                </div>
            `;
        }
        init();
    </script>
</body>
</html>